import*as d from"https://cdn.skypack.dev/d3@7";(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))i(t);new MutationObserver(t=>{for(const r of t)if(r.type==="childList")for(const c of r.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&i(c)}).observe(document,{childList:!0,subtree:!0});function s(t){const r={};return t.integrity&&(r.integrity=t.integrity),t.referrerPolicy&&(r.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?r.credentials="include":t.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function i(t){if(t.ep)return;t.ep=!0;const r=s(t);fetch(t.href,r)}})();const f=document.getElementById("tree-container"),p=document.getElementById("json-input"),h=document.getElementById("build-btn");function m(o){f.innerHTML="";const n={};o.forEach(e=>{n[e.id]={...e,children:[]}});let s=null;if(o.forEach(e=>{e.prev_nodes.length===0?s=n[e.id]:e.prev_nodes.forEach(u=>{n[u]&&n[u].children.push(n[e.id])})}),!s){alert("No root node found (node with empty prev_nodes).");return}const i=800,t=600,r=d.select(f).append("svg").attr("width",i).attr("height",t).append("g").attr("transform","translate(50,50)"),c=d.tree().size([i-100,t-100]),a=d.hierarchy(s);c(a),r.selectAll(".link").data(a.links()).enter().append("line").classed("link",!0).attr("x1",e=>e.source.x).attr("y1",e=>e.source.y).attr("x2",e=>e.target.x).attr("y2",e=>e.target.y);const l=r.selectAll(".node").data(a.descendants()).enter().append("g").classed("node",!0).attr("transform",e=>`translate(${e.x},${e.y})`);l.append("circle").attr("r",20),l.append("text").attr("dy",5).attr("text-anchor","middle").text(e=>e.data.id.slice(0,6))}h.addEventListener("click",()=>{try{const o=JSON.parse(p.value);m(o)}catch(o){alert("Invalid JSON: "+o.message)}});
